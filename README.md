# literate-parakeet
上海市教育考试院  中高考批量查询分数

***

# 2025/2/23 深夜碎碎念2

还是舍不得把项目留到下周去（）于是加班加点把新功能做完了，亲眼看着这个程序从一开始的只能截图到现在越来越方便使用，令人唏嘘不已（？

注释没写啊，打算有空了让ai给我写注释（（（

__以后也会把这个markdown重置一遍，更新也会正式一点__

我反复观察了一下现在教育考试院网站上填写框的标签还是大写的BMH、MM居多，所以代码默认的也是大写。如果发现运行报错，可以改成小写试试

然后英语春考的界面长得和别的都不一样（路径三），前两个我都进不去，估计关了，然后网页的标签也不一样，需要查春考英语的可能要多改一点代码（不过相对于以前的没有gui的版本工作量小太多了

以后应该会把改标签名称的功能加上去，等有空吧

__下周发release哦！__

祝查分好运

***

# 2025/2/23 更新

· 为程序添加了简陋的gui（仅用于自定义config）

· 增加的自定义config：Excel文件路径、查询网址、姓名列、准考证号列、密码列、成绩起始列、起始行、结束行、覆盖已有成绩、导出路径、显示浏览器界面

· 使程序写法更加规范

***

# 2025/2/23 深夜碎碎念1


这个项目过了这么久了居然还在维护（其实也没干什么事（？
今天正在着手维护这个代码啊，结果发现上海这个考试院的写法出现了一些偏差
以前的标签都是BMH，MM这些，现在居然改成了bmh，mm
也就是说这个软件没有通用性，每年每科查分的网页写法都会有差异
所以其实是对使用者的代码水平有要求的
因此我会重新写一个可读性更高的代码出来，这样改起来更方便（

***

# 2024/7/12 更新（去看最新的）


更新后作者测试了该程序，能够正常运行。若查询初三中考分数，请使用main1.py。若查询初二中考分数，请使用main2.py。若查询高考分数，请使用main.py

本次更新增加了将成绩导入进报名号.xlsx的功能。由于作者没有高考样本，无法做到将高考分数导入excel文档的功能，因此main.py中没有此功能。

需要删除html、scores、verify文件夹中的文件

***


# 免责声明


作者并非上海高考生，因此并没有任何数据能够测试此项目。

作者认为此程序有80%的概率能够正常运行。（心虚）

**（2024/7/12更新） 目前程序已测试完毕，可以正常运行**

该程序的运行需要建立在合法合规的基础上。如果需要使用该程序查分，请取得当事人允许。禁止用作商业用途。

作者对于使用者的行为不了解不知情不负责，本程序仅为交流学习使用，请勿用作非法用途。


# 注意事项


本软件使用playwright openpyxl ddddocr tkinter模块，在使用前请确保安装了python3.12版本（其他版本未经测试）以及相应的模块。

在命令行中输入：
```
pip install playwright openpyxl ddddocr tkinter
playwright install
```

请务必保证考生信息的表格格式正确：第二列为姓名，第三列为准考证号，第五列为密码。如果不按照此格式，须更改代码中的column数值。 
__（20250223更新）现在可自定义了！__

本程序使用ddddocr识别验证码，不保证识别的正确性，故文件夹中的图片可能不包含考生成绩，仍为填写考生信息的界面（有时显示验证码错误）。此时需要使用者自行查询分数。 
__（20250223更新）现在可以多次运行程序自动补齐空缺数据了！__

本程序编写时使用相对路径来存储文件。若程序运行时出现IDE无法识别等路径方面的报错，可尝试将路径修改为绝对路径。 
__（20250223更新）现在路径也可以自定义了！__

由于上海市教育考试院网站限制，运行本程序时请关闭代理，否则会出现报错等情况。


# 使用方法 （20250223更新）使用gui_main.py解君愁！可以完全自定义


· 将报名号.xlsx中的信息按照规定格式填写。（第二列为姓名，第三列为准考证号，第五列为密码。）如果不按照此格式，须更改代码中第35行至37行的column数值。（main2、main3为50~52行） 

· 将19行（main2、main3为20行）中的sheetrow修改为第一行存储数据的行数（一般来说第一行为表头，故设置为2，跳过表头直接读取第一位学生信息）

· 将26行（main2、main3为27行）的pageurl修改为需要查分的链接。

· 将97行（main2、main3为153行）的“4”修改为表格中有信息的最大行数

· （可选）将文件路径修改为绝对路径

